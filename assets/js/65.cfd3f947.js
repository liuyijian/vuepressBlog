(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{493:function(i,a,e){"use strict";e.r(a);var v=e(15),t=Object(v.a)({},(function(){var i=this,a=i.$createElement,e=i._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[e("h1",{attrs:{id:"chap7-ffmpeg采集设备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chap7-ffmpeg采集设备"}},[i._v("#")]),i._v(" Chap7 FFmpeg采集设备")]),i._v(" "),e("h2",{attrs:{id:"ffmpeg中linux设备操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg中linux设备操作"}},[i._v("#")]),i._v(" FFmpeg中Linux设备操作")]),i._v(" "),e("h4",{attrs:{id:"linux下查看设备列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux下查看设备列表"}},[i._v("#")]),i._v(" Linux下查看设备列表")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("查看系统当前支持的设备："),e("code",[i._v("ffmpeg -hide_banner -devices")])])]),i._v(" "),e("li",[e("p",[i._v("样例："),e("img",{attrs:{src:"https://tva1.sinaimg.cn/large/0081Kckwly1gk4yk6d02lj30oe0a0tb5.jpg",alt:"image-20201028125717729"}})])]),i._v(" "),e("li",[e("p",[i._v("系统支持设备（图）：")]),i._v(" "),e("ul",[e("li",[i._v("输入设备：dv1934、fbdev、lavfi、oss、v4l2、x11grab")]),i._v(" "),e("li",[i._v("输出设备：fbdev、sdl、v4l2")])])])]),i._v(" "),e("h4",{attrs:{id:"linux采集设备fbdev"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux采集设备fbdev"}},[i._v("#")]),i._v(" Linux采集设备fbdev")]),i._v(" "),e("ul",[e("li",[i._v("略")])]),i._v(" "),e("h4",{attrs:{id:"linux采集设备v4l2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux采集设备v4l2"}},[i._v("#")]),i._v(" Linux采集设备v4l2")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("Linux下常见的视频设备有video4linux2，缩写为v4l2，尤其是用于摄像头设备，其参数如下，支持设置帧率、时间戳、输入分辨率、视频帧大小等")])]),i._v(" "),e("li",[e("p",[e("img",{attrs:{src:"https://tva1.sinaimg.cn/large/0081Kckwly1gk4ysrywk5j30xy0hktg0.jpg",alt:"image-20201028130435337"}})])]),i._v(" "),e("li",[e("p",[i._v("查看设备格式支持："),e("code",[i._v("ffmpeg -hide_banner -f v4l2 -list_formats all -i /dev/video0")])])]),i._v(" "),e("li",[e("p",[i._v("采集视频文件："),e("code",[i._v("ffmpeg -hide_banner -s 1920x1080 -i /dev/video output.avi")])])])]),i._v(" "),e("h4",{attrs:{id:"linux采集设备x11grab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux采集设备x11grab"}},[i._v("#")]),i._v(" Linux采集设备x11grab")]),i._v(" "),e("ul",[e("li",[i._v("使用FFmpeg采集Linux下面的图形部分桌面图像时，通常采用x11grab设备，参数如下，支持绘制鼠标光标，跟踪鼠标 轨迹，指定采集桌面区域，设置采集视频的分辨率等")]),i._v(" "),e("li",[e("img",{attrs:{src:"https://tva1.sinaimg.cn/large/0081Kckwly1gk4yzkw3mpj31200bgwj2.jpg",alt:"image-20201028131203308"}})]),i._v(" "),e("li",[i._v("桌面录制："),e("code",[i._v("ffmpeg -f x11grab -framerate 25 -video_size 1366x768 -i :0.0 out.mp4")])]),i._v(" "),e("li",[i._v("桌面录制指定起始位置："),e("code",[i._v("ffmpeg -f x11grab -framerate 25 -video_size 352x288 -i :0.0+300,200 out.mp4")])]),i._v(" "),e("li",[i._v("桌面录制带鼠标记录的视频："),e("code",[i._v("ffmpeg -f x11grab -video_size 1366x768 -follow_mouse 1 -i :0.0 out.mp4")])])]),i._v(" "),e("h2",{attrs:{id:"ffmpeg中os-x设备操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg中os-x设备操作"}},[i._v("#")]),i._v(" FFmpeg中OS X设备操作")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("在FFmpeg中采集OS X系统的输入输出设备，常规方式采用的是OS X的avfoundation设备进行采集，参数如下，主要涉及枚举设备、音视频设备编号、像素格式、帧率、分辨率等等")])]),i._v(" "),e("li",[e("p",[e("img",{attrs:{src:"https://tva1.sinaimg.cn/large/0081Kckwly1gk4z6d2i47j311k0iatf3.jpg",alt:"image-20201028131836791"}})])]),i._v(" "),e("li",[e("p",[i._v("查看avfoundation支持的输入设备（实测卡死？）")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("命令："),e("code",[i._v('ffmpeg -f avfoundation -list_devices true -i ""')])])]),i._v(" "),e("li",[e("p",[i._v("效果：")]),i._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[i._v("[AVFoundation input device @ 0x7f96a0500460] AVFoundation video devices:\n[AVFoundation input device @ 0x7f96a0500460] [0] FaceTime HD Camera (Built-in)\n[AVFoundation input device @ 0x7f96a0500460] [1] Capture screen 0\n[AVFoundation input device @ 0x7f96a0500460] AVFoundation audio devices:\n[AVFoundation input device @ 0x7f96a0500460] [0] Built-in Microphone\n")])])])])])]),i._v(" "),e("li",[e("p",[i._v("采集内置摄像头")]),i._v(" "),e("ul",[e("li",[e("code",[i._v('ffmpeg -f avfoundation -i "FaceTime HD Camera (Built-in)" out.mp4')])])])]),i._v(" "),e("li",[e("p",[i._v("采集OS X桌面")]),i._v(" "),e("ul",[e("li",[e("code",[i._v('ffmpeg -f avfoundation -i "Capture screen 0" -r:v 30 out.mp4')])])])]),i._v(" "),e("li",[e("p",[i._v("采集麦克风")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("参数0:0 分别代表第0个视频设备和第0个音频设备")])]),i._v(" "),e("li",[e("p",[e("code",[i._v('ffmpeg -f avfoundation -i "0:0" out.aac')])])]),i._v(" "),e("li",[e("p",[i._v("使用设备索引参数指定设备采集")])]),i._v(" "),e("li",[e("p",[e("code",[i._v("ffmpeg -f avfoundation -video_device_index 0 -audio_device_index 0 out.aac")])])])])])]),i._v(" "),e("h2",{attrs:{id:"ffmpeg中windows设备操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg中windows设备操作"}},[i._v("#")]),i._v(" FFmpeg中Windows设备操作")]),i._v(" "),e("ul",[e("li",[e("p",[i._v("Windows采集设备的主要方式是dshow、vfwcap、gdigrab，其中dshow可以用来抓取摄像头、采集卡、麦克风等，vfwcap主要用来采集摄像头类设备，gdigrab则是抓取Windows窗口程序。")])]),i._v(" "),e("li",[e("p",[i._v("具体看书～")])])])])}),[],!1,null,null,null);a.default=t.exports}}]);